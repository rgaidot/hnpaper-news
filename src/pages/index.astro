---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allNews = await getCollection('news');
const sortedNews = allNews.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
const latestNews = sortedNews.slice(0, 10);
---

<Layout title="HNPaper News - L'actualité Tech essentielle">
  <div class="mb-10 text-center sm:text-left">
    <h2 class="text-2xl font-bold text-stone-800 border-b-2 border-stone-200 pb-2 inline-block">À la Une</h2>
  </div>

  <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-2">
    {
      latestNews.map((post, index) => (
        <article class={`bg-white rounded-none border border-stone-200 p-6 shadow-sm hover:shadow-md hover:border-blue-300 transition-all duration-300 flex flex-col ${index === 0 ? 'sm:col-span-2 sm:p-8 border-stone-300 shadow-md' : ''}`}>
          <div class="mb-3 flex items-center text-xs font-bold tracking-wider text-blue-600 uppercase">
             {new Date(post.data.date).toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}
          </div>
          
          <h3 class={`font-bold text-stone-900 leading-tight mb-3 group-hover:text-blue-700 ${index === 0 ? 'text-3xl sm:text-4xl' : 'text-xl'}`}>
            <a href={`/news/${post.slug}`} class="hover:underline decoration-2 decoration-blue-100 underline-offset-2">
              {post.data.title}
            </a>
          </h3>
          
          <p class={`text-stone-600 font-serif leading-relaxed mb-4 flex-grow ${index === 0 ? 'text-lg' : 'text-base'}`}>
            {post.body.split('---')[0]?.substring(0, index === 0 ? 350 : 150).replace(/^#+\s/, '')}...
          </p>

          <div class="mt-auto pt-4 border-t border-stone-100 flex justify-between items-center text-sm">
             <span class="text-stone-400 italic">Par {post.data.author}</span>
             <a href={`/news/${post.slug}`} class="font-bold text-blue-600 hover:text-blue-800 transition-colors">
               Lire l'article &rarr;
             </a>
          </div>
        </article>
      ))
    }
  </div>

  <div class="mt-16 text-center">
    <a href="/news" class="inline-block px-8 py-3 border-2 border-stone-800 text-stone-800 font-bold uppercase tracking-widest hover:bg-stone-800 hover:text-white transition-all duration-300">
      Voir les archives
    </a>
  </div>
</Layout>
