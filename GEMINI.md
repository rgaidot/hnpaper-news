# Project Context: HNPaper News

## Project Overview
**HNPaper News** is a static website built with **Astro** that serves as an automated news aggregator/archive. It publishes daily summaries of news from [HNPaper](https://hnpaper-labs.gaidot.net). The site is designed to be hosted on **GitHub Pages**. The primary language of the content is **French**.

## Key Directories and Files
*   **`astro.config.mjs`**: The main configuration file for Astro. Configured with **TailwindCSS v4**, **Vite PWA**, and the site URL `https://hnpaper-news-labs.gaidot.net`.
*   **`src/content/news/`**: Contains the individual news posts. Files follow the naming convention `YYYY-MM-DD-HHMM.md`.
*   **`src/content/config.ts`**: Defines the `news` content collection schema using Zod.
*   **`src/pages/index.astro`**: The entry point of the site, which loops through and displays recent posts.
*   **`.github/workflows/deploy.yml`**: The GitHub Actions workflow that automatically builds and deploys the site to GitHub Pages upon pushing to the `main` branch.
*   **`src/styles/global.css`**: Global CSS styles.
*   **`src/components/TTSPlayer.astro`**: Astro component responsible for rendering the Text-to-Speech player.
*   **`src/scripts/client/TTSController.ts`**: TypeScript module that manages the client-side logic for Text-to-Speech playback.
*   **`src/scripts/client/ArticleNavigation.ts`**: TypeScript module handling article section navigation and UI interactions.

## Development & Usage

### Building and Running Locally
To run the site locally, you would typically use the standard Node.js commands (assuming Node.js and npm are set up):

1.  **Install Dependencies:**
    ```bash
    bun install
    ```
2.  **Serve the Site:**
    ```bash
    bun run dev
    ```
    This will build the site and host it locally.
3.  **Build for production**
    ```bash
    bun run build
    ```
    The generated files will be in the `dist/` folder.
4.  **Preview the production build**
    ```bash
    bun run preview
    ```

### Creating New Posts
New posts are added to the `src/content/news/` directory.

*   **Filename Format:** `YYYY-MM-DD-HHMM.md` (e.g., `2026-01-27-1400.md`)
*   **Content Structure:**
    Each post uses YAML front matter followed by the content in Markdown.
    ```markdown
    ---
    title: "Actualités du 27/01/2026 à 14:00"
    date: 2026-01-27T14:00:00+01:00
    author: HNPaper Bot
    tags: [news]
    ---
    (Post content goes here...)
    ```

### Deployment
The site is deployed automatically via GitHub Actions.
*   **Trigger:** Pushing to the `main` branch.
*   **Workflow:** The workflow defined in `.github/workflows/deploy.yml` builds the Astro site and pushes the artifacts to the `gh-pages` environment.

## Conventions
*   **Language:** The content and UI text are in **French**.
*   **Framework:** The site uses **Astro** with **Tailwind CSS v4**.
*   **Automation:** The posts appear to be generated by a bot (`HNPaper Bot`), suggesting an external process or script (possibly running elsewhere) commits these files to the repository.

## Features & Architecture

### PWA (Progressive Web App)
The site is configured as a PWA using `@vite-pwa/astro`.
*   **Offline Support**: Uses Workbox to cache assets and content for offline reading.
*   **Installable**: Manifest file allows installation on mobile/desktop.

### Text-to-Speech (TTS)
The website integrates Text-to-Speech capabilities to allow users to listen to the news articles.
*   **`TTSPlayer.astro`**: UI component for playback controls.
*   **`TTSController.ts`**: Manages audio playback using the Web Speech API. It communicates with other components via custom window events (e.g., `tts:cmd:toggle`, `tts:state-changed`).

### Article Navigation
*   **`ArticleNavigation.ts`**: Provides advanced navigation features within articles.
    *   **Sectioning**: Automatically detects sections based on horizontal rules (`<hr>`) and adds anchor links.
    *   **Scroll Spy**: Highlights the current section in the floating UI as the user scrolls.
    *   **Keyboard Shortcuts**: Supports `ArrowLeft`/`ArrowRight` for section navigation and `Space` for toggling TTS playback.
    *   **Integration**: Syncs with the TTS controller to play the specific section currently in view when navigation occurs.
